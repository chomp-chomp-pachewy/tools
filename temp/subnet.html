<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subnet Calculator - Chomp Tools</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/tools-recipes-style.css">
</head>
<body>
    <header class="site-header">
        <nav class="site-nav">
            <a href="https://www.chomp.ltd" class="site-logo">chomp chomp</a>
            <button class="menu-toggle" aria-label="Toggle menu">☰</button>
            <ul class="nav-links">
                <li><a href="https://www.chomp.ltd">home</a></li>
                <li><a href="https://recipes.chomp.ltd">recipes</a></li>
                <li><a href="https://tools.chomp.ltd">tools</a></li>
            </ul>
        </nav>
    </header>

    <div class="page-container">
        <div class="tool-page">
            <div class="tool-header">
                <h1 class="tool-title">Subnet Calculator</h1>
                <p class="tool-subtitle">Calculate subnet masks, CIDR notation & network ranges</p>
            </div>

            <div class="tool-controls">
                <div class="control-group">
                    <label class="control-label">IP Address</label>
                    <input type="text" id="ipAddress" class="form-input" placeholder="192.168.1.0" value="192.168.1.0">
                </div>

                <div class="control-group">
                    <label class="control-label">CIDR / Subnet Mask</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="number" id="cidr" class="form-input" placeholder="24" value="24" min="0" max="32" style="flex: 1;">
                        <input type="text" id="subnetMask" class="form-input" placeholder="255.255.255.0" value="255.255.255.0" style="flex: 2;">
                    </div>
                </div>

                <div class="tool-actions">
                    <button class="tool-button" onclick="calculate()">Calculate</button>
                    <button class="tool-button tool-button-secondary" onclick="reset()">Reset</button>
                </div>
            </div>

            <div class="tool-results" id="results" style="display: none;">
                <div class="result-item">
                    <div class="result-label">Network Address</div>
                    <div class="result-value" id="networkAddress">192.168.1.0</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Broadcast Address</div>
                    <div class="result-value" id="broadcastAddress">192.168.1.255</div>
                </div>
                <div class="result-item">
                    <div class="result-label">First Usable IP</div>
                    <div class="result-value" id="firstIP">192.168.1.1</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Last Usable IP</div>
                    <div class="result-value" id="lastIP">192.168.1.254</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Total Hosts</div>
                    <div class="result-value" id="totalHosts">256</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Usable Hosts</div>
                    <div class="result-value" id="usableHosts">254</div>
                </div>
                <div class="result-item">
                    <div class="result-label">CIDR Notation</div>
                    <div class="result-value" id="cidrNotation">/24</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Subnet Mask</div>
                    <div class="result-value" id="subnetMaskResult">255.255.255.0</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Wildcard Mask</div>
                    <div class="result-value" id="wildcardMask">0.0.0.255</div>
                </div>
            </div>

            <div class="info-box">
                <p><strong>How to use:</strong> Enter an IP address and either a CIDR notation (0-32) or subnet mask. The calculator will automatically compute all subnet details including network address, broadcast address, and usable host range.</p>
            </div>

            <div style="text-align: center; margin-top: 40px;">
                <a href="index.html" class="btn btn-outline">← Back to Tools</a>
            </div>
        </div>
    </div>

    <footer class="site-footer">
        <div class="footer-content">
            <p>&copy; 2024 Chomp Chomp. All rights reserved.</p>
            <div class="footer-links">
                <a href="mailto:tools@chomp.ltd">Contact</a>
                <a href="https://www.chomp.ltd">Home</a>
            </div>
        </div>
    </footer>

    <script>
        // Mobile menu toggle
        const menuToggle = document.querySelector('.menu-toggle');
        const navLinks = document.querySelector('.nav-links');

        menuToggle.addEventListener('click', () => {
            navLinks.classList.toggle('active');
        });

        document.addEventListener('click', (e) => {
            if (!e.target.closest('.site-nav')) {
                navLinks.classList.remove('active');
            }
        });

        // Subnet calculation logic
        function ipToInt(ip) {
            return ip.split('.').reduce((acc, octet) => (acc << 8) + parseInt(octet), 0) >>> 0;
        }

        function intToIp(int) {
            return [
                (int >>> 24) & 0xFF,
                (int >>> 16) & 0xFF,
                (int >>> 8) & 0xFF,
                int & 0xFF
            ].join('.');
        }

        function cidrToMask(cidr) {
            const mask = ~(2 ** (32 - cidr) - 1);
            return intToIp(mask >>> 0);
        }

        function maskToCidr(mask) {
            const binary = ipToInt(mask).toString(2);
            return binary.split('1').length - 1;
        }

        function calculate() {
            const ipInput = document.getElementById('ipAddress').value;
            const cidrInput = document.getElementById('cidr').value;
            const maskInput = document.getElementById('subnetMask').value;

            // Validate IP
            const ipPattern = /^(\d{1,3}\.){3}\d{1,3}$/;
            if (!ipPattern.test(ipInput)) {
                alert('Invalid IP address format');
                return;
            }

            let cidr;
            if (cidrInput) {
                cidr = parseInt(cidrInput);
                if (cidr < 0 || cidr > 32) {
                    alert('CIDR must be between 0 and 32');
                    return;
                }
                document.getElementById('subnetMask').value = cidrToMask(cidr);
            } else if (maskInput && ipPattern.test(maskInput)) {
                cidr = maskToCidr(maskInput);
                document.getElementById('cidr').value = cidr;
            } else {
                alert('Please provide either CIDR or a valid subnet mask');
                return;
            }

            const ipInt = ipToInt(ipInput);
            const maskInt = ipToInt(cidrToMask(cidr));
            const wildcardInt = ~maskInt >>> 0;

            const networkInt = (ipInt & maskInt) >>> 0;
            const broadcastInt = (networkInt | wildcardInt) >>> 0;
            const firstUsableInt = networkInt + 1;
            const lastUsableInt = broadcastInt - 1;

            const totalHosts = Math.pow(2, 32 - cidr);
            const usableHosts = totalHosts > 2 ? totalHosts - 2 : totalHosts;

            // Display results
            document.getElementById('networkAddress').textContent = intToIp(networkInt);
            document.getElementById('broadcastAddress').textContent = intToIp(broadcastInt);
            document.getElementById('firstIP').textContent = intToIp(firstUsableInt);
            document.getElementById('lastIP').textContent = intToIp(lastUsableInt);
            document.getElementById('totalHosts').textContent = totalHosts.toLocaleString();
            document.getElementById('usableHosts').textContent = usableHosts.toLocaleString();
            document.getElementById('cidrNotation').textContent = `/${cidr}`;
            document.getElementById('subnetMaskResult').textContent = cidrToMask(cidr);
            document.getElementById('wildcardMask').textContent = intToIp(wildcardInt);

            document.getElementById('results').style.display = 'block';
        }

        function reset() {
            document.getElementById('ipAddress').value = '192.168.1.0';
            document.getElementById('cidr').value = '24';
            document.getElementById('subnetMask').value = '255.255.255.0';
            document.getElementById('results').style.display = 'none';
        }

        // Update mask when CIDR changes
        document.getElementById('cidr').addEventListener('input', (e) => {
            const cidr = parseInt(e.target.value);
            if (cidr >= 0 && cidr <= 32) {
                document.getElementById('subnetMask').value = cidrToMask(cidr);
            }
        });

        // Update CIDR when mask changes
        document.getElementById('subnetMask').addEventListener('input', (e) => {
            const mask = e.target.value;
            const ipPattern = /^(\d{1,3}\.){3}\d{1,3}$/;
            if (ipPattern.test(mask)) {
                document.getElementById('cidr').value = maskToCidr(mask);
            }
        });
    </script>
</body>
</html>
