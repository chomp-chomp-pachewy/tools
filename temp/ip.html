<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your IP - Chomp Tools</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/tools-recipes-style.css">
</head>
<body>
    <header class="site-header">
        <nav class="site-nav">
            <a href="index.html" class="site-logo">
                <div class="site-logo-icon">
                    <img src="https://firebasestorage.googleapis.com/v0/b/chomp-chomp-recipes.firebasestorage.app/o/posts%2Fimages%2F1764704134358_IMG_3432.png?alt=media&token=24b33f57-609c-452c-b7cb-9e5cdf85859c" alt="Chomp Chomp" class="logo-default">
                    <img src="https://firebasestorage.googleapis.com/v0/b/chomp-chomp-recipes.firebasestorage.app/o/posts%2Fimages%2F1764704133716_IMG_3433.jpeg?alt=media&token=94d04258-f7c1-4eed-983a-a0eaad6c4f0b" alt="Chomp Chomp" class="logo-hover">
                </div>
            </a>
            <button class="menu-toggle" aria-label="Toggle menu">☰</button>
            <div class="nav-tools-dropdown">
                <button class="tools-dropdown-btn" onclick="toggleToolsDropdown()">Menu ▼</button>
                <ul class="tools-dropdown-menu" id="toolsDropdown">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="ip.html">Your IP</a></li>
                    <li><a href="convert.html">Convert</a></li>
                    <li><a href="encode.html">Encode</a></li>
                    <li><a href="dante.html">Inferno Ipsum</a></li>
                    <li><a href="nautical.html">Nautical Ipsum</a></li>
                    <li><a href="subnet.html">Subnet Calculator</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <div class="page-container">
        <div class="tool-page">
            <div class="tool-header">
                <img src="https://firebasestorage.googleapis.com/v0/b/chomp-chomp-recipes.firebasestorage.app/o/posts%2Fimages%2F1764737718159_who.jpg?alt=media&token=28824a87-af8b-4b86-877c-ceb566e7a260" alt="your ip">
                <p class="tool-subtitle">Find your IP address, location & network information</p>
            </div>

            <div class="tool-controls" style="text-align: center;">
                <div style="margin: 30px 0;">
                    <div style="font-size: 0.9em; color: var(--color-text-muted); margin-bottom: 10px;">Your IP Address</div>
                    <div id="ipDisplay" style="font-size: 2em; font-weight: 600; color: var(--color-accent); font-family: 'Courier New', monospace;">
                        Loading...
                    </div>
                </div>

                <div class="tool-actions">
                    <button class="tool-button" onclick="lookupIP()">Get Details</button>
                    <button class="tool-button tool-button-secondary" onclick="copyIP(event)">Copy IP</button>
                    <button class="tool-button tool-button-secondary" onclick="copyAllDetails(event)" id="copyAllBtn" style="display: none;">Copy All Details</button>
                </div>
            </div>

            <div class="tool-results" id="results" style="display: none;">
                <h3 style="margin-bottom: 15px; color: var(--color-text);">IP Address Information</h3>
                <div class="result-item">
                    <div class="result-label">IP Address</div>
                    <div class="result-value" id="ip">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">City</div>
                    <div class="result-value" id="city">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">State/Region</div>
                    <div class="result-value" id="region">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Postal Code</div>
                    <div class="result-value" id="postal">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Country</div>
                    <div class="result-value" id="country">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Coordinates</div>
                    <div class="result-value" id="coordinates">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Time Zone</div>
                    <div class="result-value" id="timezone">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Local Time</div>
                    <div class="result-value" id="localtime">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">ISP</div>
                    <div class="result-value" id="isp">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Domain</div>
                    <div class="result-value" id="domain">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Organization</div>
                    <div class="result-value" id="org">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">ASN</div>
                    <div class="result-value" id="asn">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Network IP Range</div>
                    <div class="result-value" id="network">-</div>
                </div>
            </div>

            <div class="tool-results" id="whoisResults" style="display: none; margin-top: 20px;">
                <h3 style="margin-bottom: 15px; color: var(--color-text);">IP Address WHOIS</h3>
                <div class="result-item" style="border-bottom: none;">
                    <textarea id="whoisData" readonly style="width: 100%; min-height: 300px; font-family: 'Courier New', monospace; font-size: 0.85em; line-height: 1.6; padding: 15px; background-color: var(--color-bg); border: 1px solid var(--color-border); border-radius: 8px; color: var(--color-text);">Loading WHOIS data...</textarea>
                </div>
            </div>

            <div class="tool-results" id="browserDetails" style="display: none; margin-top: 20px;">
                <h3 style="margin-bottom: 15px; color: var(--color-text);">Additional Details</h3>
                <div class="result-item">
                    <div class="result-label">User Agent</div>
                    <div class="result-value" id="userAgent" style="word-break: break-word;">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Screen Resolution</div>
                    <div class="result-value" id="screenRes">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Browser Language</div>
                    <div class="result-value" id="browserLang">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Platform</div>
                    <div class="result-value" id="platform">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Cookies Enabled</div>
                    <div class="result-value" id="cookies">-</div>
                </div>
                <div class="result-item">
                    <div class="result-label">Do Not Track</div>
                    <div class="result-value" id="dnt">-</div>
                </div>
            </div>

            <div class="info-box">
                <p><strong>Privacy Note:</strong> This tool displays your public IP address as seen by external servers. IP geolocation data is approximate and may not reflect your exact location. No personal data is stored.</p>
            </div>

            <div style="text-align: center; margin-top: 40px;">
                <a href="index.html" class="btn btn-outline">← Back to Tools</a>
            </div>
        </div>
    </div>

    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-links">
                <a href="mailto:hi@chomp.ltd">hi@chomp.ltd</a>
                <a href="https://www.chomp.ltd">chomp chomp: cookies, etc.</a>
                <a href="https://recipes.chomp.ltd">chomp chomp: recipes & rituals</a>
            </div>
            <p style="margin-top: 15px;">&copy; 2025 Chomp Chomp</p>
        </div>
    </footer>

    <script>
        // Tools dropdown toggle
        function toggleToolsDropdown() {
            const dropdown = document.getElementById('toolsDropdown');
            dropdown.classList.toggle('active');
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.nav-tools-dropdown')) {
                const dropdown = document.getElementById('toolsDropdown');
                if (dropdown) {
                    dropdown.classList.remove('active');
                }
            }
        });

        // Mobile menu toggle
        const menuToggle = document.querySelector('.menu-toggle');
        const toolsDropdown = document.querySelector('.nav-tools-dropdown');

        if (menuToggle && toolsDropdown) {
            menuToggle.addEventListener('click', () => {
                toolsDropdown.classList.toggle('active');
            });
        }

        let currentIP = '';

        // Get IP address on page load
        async function getIP() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                currentIP = data.ip;
                document.getElementById('ipDisplay').textContent = currentIP;
            } catch (error) {
                document.getElementById('ipDisplay').textContent = 'Unable to fetch IP';
                console.error('Error fetching IP:', error);
            }
        }

        // Lookup detailed IP information
        async function lookupIP() {
            if (!currentIP) {
                alert('IP address not loaded yet');
                return;
            }

            try {
                const response = await fetch(`https://ipapi.co/${currentIP}/json/`);
                const data = await response.json();

                if (data.error) {
                    alert('Error fetching IP details: ' + data.reason);
                    return;
                }

                // Populate IP information
                document.getElementById('ip').textContent = data.ip || '-';
                document.getElementById('city').textContent = data.city || '-';
                document.getElementById('region').textContent = data.region || '-';
                document.getElementById('postal').textContent = data.postal || '-';
                document.getElementById('country').textContent = `${data.country_code || '-'}`;

                // Format coordinates
                const lat = data.latitude || '-';
                const lon = data.longitude || '-';
                document.getElementById('coordinates').textContent = lat !== '-' && lon !== '-' ? `${lat}, ${lon}` : '-';

                // Format timezone with UTC offset
                const tz = data.timezone || '-';
                const utcOffset = data.utc_offset || '';
                document.getElementById('timezone').textContent = utcOffset ? `UTC ${utcOffset}` : tz;

                // Format local time
                const now = new Date();
                const localTimeStr = now.toLocaleDateString('en-US', {
                    weekday: 'short',
                    year: 'numeric',
                    month: 'short',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                document.getElementById('localtime').textContent = localTimeStr;

                document.getElementById('isp').textContent = data.org || '-';
                document.getElementById('domain').textContent = data.ip || '-';
                document.getElementById('org').textContent = data.org || '-';
                document.getElementById('asn').textContent = data.asn || '-';

                // Format network range
                const network = data.network || '-';
                document.getElementById('network').textContent = network !== '-' ? `${network} (${data.ip || ''})` : '-';

                // Display results
                document.getElementById('results').style.display = 'block';

                // Fetch and display WHOIS data
                fetchWHOIS(currentIP);

                // Display browser/system details
                displayBrowserDetails();

                // Show the "Copy All Details" button
                document.getElementById('copyAllBtn').style.display = 'inline-block';

            } catch (error) {
                alert('Error fetching IP details. Please try again.');
                console.error('Error:', error);
            }
        }

        // Fetch WHOIS data
        async function fetchWHOIS(ip) {
            try {
                // Note: WHOIS API may require authentication or have rate limits
                // Using a simulated WHOIS response or try ipapi.co whois endpoint
                const response = await fetch(`https://ipapi.co/${ip}/json/`);
                const data = await response.json();

                // Format WHOIS-like output
                let whoisText = `#\n# WHOIS data for ${ip}\n#\n\n`;
                whoisText += `NetRange:       ${data.network || 'N/A'}\n`;
                whoisText += `CIDR:           ${data.network || 'N/A'}\n`;
                whoisText += `NetName:        ${data.org || 'N/A'}\n`;
                whoisText += `Organization:   ${data.org || 'N/A'}\n`;
                whoisText += `ASN:            ${data.asn || 'N/A'}\n`;
                whoisText += `Country:        ${data.country_name || 'N/A'} (${data.country_code || 'N/A'})\n`;
                whoisText += `Region:         ${data.region || 'N/A'}\n`;
                whoisText += `City:           ${data.city || 'N/A'}\n`;
                whoisText += `Postal:         ${data.postal || 'N/A'}\n`;
                whoisText += `Timezone:       ${data.timezone || 'N/A'}\n`;
                whoisText += `Coordinates:    ${data.latitude || 'N/A'}, ${data.longitude || 'N/A'}\n\n`;
                whoisText += `OrgName:        ${data.org || 'N/A'}\n`;
                whoisText += `OrgTechEmail:   N/A\n`;
                whoisText += `OrgTechPhone:   N/A\n\n`;
                whoisText += `# Additional information may be available from regional registries\n`;
                whoisText += `# (ARIN, RIPE, APNIC, LACNIC, AFRINIC)\n`;

                document.getElementById('whoisData').value = whoisText;
                document.getElementById('whoisResults').style.display = 'block';
            } catch (error) {
                document.getElementById('whoisData').value = 'Unable to fetch WHOIS data';
                document.getElementById('whoisResults').style.display = 'block';
                console.error('WHOIS error:', error);
            }
        }

        // Display browser and system details
        function displayBrowserDetails() {
            document.getElementById('userAgent').textContent = navigator.userAgent || '-';
            document.getElementById('screenRes').textContent = `${screen.width} x ${screen.height}` || '-';
            document.getElementById('browserLang').textContent = navigator.language || '-';
            document.getElementById('platform').textContent = navigator.platform || '-';
            document.getElementById('cookies').textContent = navigator.cookieEnabled ? 'yes' : 'no';
            document.getElementById('dnt').textContent = navigator.doNotTrack || '0';

            document.getElementById('browserDetails').style.display = 'block';
        }

        // Copy IP to clipboard
        function copyIP(e) {
            if (!currentIP) {
                alert('IP address not loaded yet');
                return;
            }

            navigator.clipboard.writeText(currentIP).then(() => {
                const btn = e.target;
                const originalText = btn.textContent;
                btn.textContent = 'Copied!';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 2000);
            }).catch(err => {
                alert('Failed to copy IP address');
                console.error('Copy error:', err);
            });
        }

        // Copy all details to clipboard
        function copyAllDetails(e) {
            let allDetails = '=== MY IP ADDRESS ===\n\n';
            allDetails += `IP Address: ${document.getElementById('ip').textContent}\n`;
            allDetails += `City: ${document.getElementById('city').textContent}\n`;
            allDetails += `State/Region: ${document.getElementById('region').textContent}\n`;
            allDetails += `Postal Code: ${document.getElementById('postal').textContent}\n`;
            allDetails += `Country: ${document.getElementById('country').textContent}\n`;
            allDetails += `Coordinates: ${document.getElementById('coordinates').textContent}\n`;
            allDetails += `Time Zone: ${document.getElementById('timezone').textContent}\n`;
            allDetails += `Local Time: ${document.getElementById('localtime').textContent}\n`;
            allDetails += `ISP: ${document.getElementById('isp').textContent}\n`;
            allDetails += `Domain: ${document.getElementById('domain').textContent}\n`;
            allDetails += `Organization: ${document.getElementById('org').textContent}\n`;
            allDetails += `ASN: ${document.getElementById('asn').textContent}\n`;
            allDetails += `Network IP Range: ${document.getElementById('network').textContent}\n\n`;

            allDetails += '=== IP ADDRESS WHOIS ===\n\n';
            allDetails += document.getElementById('whoisData').value + '\n\n';

            allDetails += '=== ADDITIONAL DETAILS ===\n\n';
            allDetails += `User Agent: ${document.getElementById('userAgent').textContent}\n`;
            allDetails += `Screen Resolution: ${document.getElementById('screenRes').textContent}\n`;
            allDetails += `Browser Language: ${document.getElementById('browserLang').textContent}\n`;
            allDetails += `Platform: ${document.getElementById('platform').textContent}\n`;
            allDetails += `Cookies Enabled: ${document.getElementById('cookies').textContent}\n`;
            allDetails += `Do Not Track: ${document.getElementById('dnt').textContent}\n`;

            navigator.clipboard.writeText(allDetails).then(() => {
                const btn = e.target;
                const originalText = btn.textContent;
                btn.textContent = 'Copied!';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 2000);
            }).catch(err => {
                alert('Failed to copy details');
                console.error('Copy error:', err);
            });
        }

        // Load IP on page load
        window.addEventListener('load', getIP);
    </script>
</body>
</html>
